<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { font-family: sans-serif; background: #f4f7f6; padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); max-width: 400px; margin: auto; }
        input { width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 10px; font-size: 20px; text-align: center; box-sizing: border-box; }
        .btn { width: 100%; padding: 15px; background: #007bff; color: white; border: none; border-radius: 10px; margin-top: 10px; cursor: pointer; }
        .res { display: none; margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 5px solid #007bff; }
    </style>
</head>
<body>
<div class="card">
    <h2 style="text-align:center">üîç ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h2>
    <input type="number" id="tid" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏á‡∏≤‡∏ô ‡πÄ‡∏ä‡πà‡∏ô 1 ‡∏´‡∏£‡∏∑‡∏≠ 001">
    <button class="btn" onclick="track()">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
    <div id="result" class="res">
        <b id="rId"></b> <span id="rStat" style="background:#007bff; color:white; padding:2px 8px; border-radius:10px; font-size:12px;"></span>
        <p id="rDetail" style="font-size:14px; margin-top:10px;"></p>
    </div>
</div>
<script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbw--VKbuz97SHq7fDnNf6qg4oLNJPbYI31bS-XPvvRQwyrshnUoNetSBVKAJg9h6_Cy/exec";
    const LIFF_ID = "2008875334-wOYUvNha";
    let uId = "";
    async function init() {
        await liff.init({ liffId: LIFF_ID });
        if(!liff.isLoggedIn()) liff.login();
        else { const p = await liff.getProfile(); uId = p.userId; }
    }
    async function track() {
        const v = document.getElementById('tid').value;
        const res = await fetch(`${WEB_APP_URL}?action=track&tid=${v}&uid=${uId}`);
        const d = await res.json();
        if(d.found) {
            document.getElementById('rId').innerText = d.ticketId;
            document.getElementById('rStat').innerText = d.status;
            document.getElementById('rDetail').innerHTML = `<b>‡∏õ‡∏±‡∏ç‡∏´‡∏≤:</b> ${d.issue}<br><b>‡∏ä‡πà‡∏≤‡∏á:</b> ${d.admin}`;
            document.getElementById('result').style.display = 'block';
        } else { alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"); }
    }
    init();
</script>
</body>
</html>
