// ... (‡∏™‡πà‡∏ß‡∏ô HTML/CSS ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ...

async function loadJobs() {
    document.getElementById("loading").style.display = "block";
    const res = await fetch(`${WEB_APP_URL}?action=listPending`);
    const jobs = await res.json();
    document.getElementById("loading").style.display = "none";
    
    const listDiv = document.getElementById("jobList");
    listDiv.innerHTML = "";

    const profile = await liff.getProfile(); // ‡∏î‡∏∂‡∏á Profile ‡∏Ç‡∏≠‡∏á Admin ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    const myUid = profile.userId;

    jobs.forEach(job => {
        // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏Ñ‡∏™‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ñ‡∏ô‡∏£‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
        const adminInfo = job.admin ? `(‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢: ${job.admin === myUid ? '‡∏Ñ‡∏∏‡∏ì' : 'Admin ‡∏ó‡πà‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô'})` : '(‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô)';
        
        listDiv.innerHTML += `
            <div class="job-card" style="border-left: 5px solid ${job.admin === myUid ? '#06C755' : '#ccc'}">
                <div style="display:flex; justify-content:space-between">
                    <span class="ticket-id">${job.ticketId}</span>
                    <span class="status-tag">${job.status}</span>
                </div>
                <p style="margin:5px 0"><b>‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á:</b> ${job.name} <br> <small>${adminInfo}</small></p>
                <p style="font-size:14px; color:#666">${job.issue}</p>
                <div class="btn-group">
                    <button class="btn-work" onclick="updateStatus(${job.row}, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', '${myUid}')">üíª ‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô/‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</button>
                    <button class="btn-done" onclick="updateStatus(${job.row}, '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', '${myUid}')">‚úÖ ‡∏õ‡∏¥‡∏î‡∏á‡∏≤‡∏ô</button>
                </div>
            </div>
        `;
    });
}

async function updateStatus(row, status, adminUid) {
    if (!confirm(`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô: ${status}`)) return;
    // ‡∏™‡πà‡∏á adminUid ‡πÑ‡∏õ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏î‡πâ‡∏ß‡∏¢
    await fetch(`${WEB_APP_URL}?action=updateStatus&row=${row}&status=${status}&adminUid=${adminUid}`);
    loadJobs();
}

// ... (‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ...
